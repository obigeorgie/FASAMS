{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "FASAMS Client and Treatment Episode Data Schema",
    "description": "Strict validation schema for Florida DCF FASAMS 155-2 Chapter 4 (Client Data) and Chapter 5 (Treatment Episode) requirements.",
    "type": "object",
    "required": [
        "SSN",
        "Medicaid_ID",
        "Provider_ID",
        "Admission_Date",
        "Project_Code",
        "Diagnosis_Code_ICD10"
    ],
    "properties": {
        "SSN": {
            "type": "string",
            "description": "Social Security Number must be exactly 9 digits, no dashes.",
            "pattern": "^\\d{9}$"
        },
        "Medicaid_ID": {
            "type": "string",
            "description": "Florida Medicaid Recipient ID must be exactly 10 digits.",
            "pattern": "^\\d{10}$"
        },
        "Provider_ID": {
            "type": "string",
            "description": "Unique identifier for the provider agency. Alphanumeric pattern enforced.",
            "pattern": "^[a-zA-Z0-9]{9,20}$"
        },
        "Admission_Date": {
            "type": "string",
            "description": "The date the client was admitted to the treatment episode. Must be YYYY-MM-DD and is required.",
            "format": "date"
        },
        "Project_Code": {
            "type": "string",
            "description": "Project codes defined in Pamphlet 155-2 Appendix 1.",
            "enum": [
                "A0",
                "A1",
                "A2",
                "A3",
                "A4",
                "A5",
                "A6",
                "A7",
                "A8",
                "A9",
                "B1",
                "B2",
                "B3",
                "B4",
                "B5",
                "B6",
                "B7",
                "B8",
                "B9",
                "C0",
                "C1",
                "C2",
                "C3",
                "C4"
            ]
        },
        "Diagnosis_Code_ICD10": {
            "type": "string",
            "description": "Primary diagnosis code based on ICD-10 standards.",
            "pattern": "^[A-TV-Z][0-9AB](?:\\.[0-9A-K]{1,4})?$"
        },
        "Grant_Type": {
            "type": "string",
            "description": "The type of grant funding the episode (e.g., SOR, Recovery Housing)."
        },
        "Sex": {
            "type": "string",
            "description": "Client's biological sex.",
            "enum": [
                "Male",
                "Female",
                "Unknown"
            ]
        },
        "Age": {
            "type": [
                "integer",
                "string"
            ],
            "description": "Client's age at admission.",
            "pattern": "^\\d+$"
        },
        "6-Month Follow-up": {
            "type": "string",
            "description": "Date of the 6-month follow-up, if applicable.",
            "format": "date"
        }
    },
    "allOf": [
        {
            "if": {
                "properties": {
                    "Project_Code": {
                        "const": "A1"
                    }
                }
            },
            "then": {
                "properties": {
                    "OCA": {
                        "const": "MH0BN"
                    }
                }
            },
            "description": "Rule: Project Code A1 (BNET) requires OCA MH0BN [Appendix 1]."
        },
        {
            "if": {
                "properties": {
                    "Project_Code": {
                        "const": "A5"
                    }
                }
            },
            "then": {
                "properties": {
                    "OCA": {
                        "const": "MH026"
                    }
                }
            },
            "description": "Rule: Project Code A5 (First Episode Team) requires OCA MH026 [Appendix 1]."
        }
    ],
    "additionalProperties": false
}